<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calibrating and Using the navX-sensor IMU &mdash; Studica Robotics 1.0.0 documentation</title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/studica-rtd.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" /><link rel="shortcut icon" href="../../_static/Studica_Favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Updating Firmware" href="update.html" />
    <link rel="prev" title="Configuring and Testing the SR Pro Camera" href="vision.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Studica Robotics<img src="../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/index.html">Getting Started</a></li>
</ul>
<p class="caption"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://www.studica.com/downloads/Studica-Robotics/FRC-WSR/Titan/Docs/JavaAPIDocs/annotated.html">Java API</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.studica.com/downloads/Studica-Robotics/FRC-WSR/Titan/Docs/CppAPIDocs/annotated.html">C++ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Software/software-setup/index.html">Software Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Software/programming/index.html">Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labview/setup/index.html">LabVIEW Setup (Beta)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labview/toolkit/index.html">LabVIEW Toolkit (Beta)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labview/using-labview/index.html">Using LabVIEW (Beta)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Software/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">Control Station</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ControlStation/index.html">Control Station</a></li>
</ul>
<p class="caption"><span class="caption-text">Building System</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../BuildingSystem/robotics-and-control-systems/index.html">Robotics and Control Systems</a></li>
</ul>
<p class="caption"><span class="caption-text">VMX</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="networking.html">Networking</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Connecting Sensors and Actuators</a></li>
<li class="toctree-l1"><a class="reference internal" href="wpi-channel-addressing.html">WPI Channel Addressing</a></li>
<li class="toctree-l1"><a class="reference internal" href="vision.html">Configuring and Testing the SR Pro Camera</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Calibrating and Using the navX-sensor IMU</a></li>
<li class="toctree-l1"><a class="reference internal" href="update.html">Updating Firmware</a></li>
<li class="toctree-l1"><a class="reference internal" href="os-image.html">VMX OS Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">Titan</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Titan/titan.html">Titan Quad</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Titan/programing-the-titan.html">Programming the Titan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Titan/download-update-app.html">Download Update App</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Titan/using-the-update-app.html">Using the Update App</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Titan/titan-status-light.html">Titan Status Light</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Titan/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">Sensors</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Sensors/cobra.html">Cobra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Sensors/ultrasonic.html">Ultrasonic Distance Sensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Sensors/sharpIR.html">Sharp IR Distance Sensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Sensors/limit-switches.html">Limit Switches</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Sensors/encoders.html">Encoders</a></li>
</ul>
<p class="caption"><span class="caption-text">Vision</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Vision/sr-pro-camera.html">SR Pro Camera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Vision/installing-the-ribbon-cable.html">Installing the Ribbon Cable</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Vision/reading-a-barcode/index.html">Reading a Barcode</a></li>
</ul>
<p class="caption"><span class="caption-text">Motors</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Motors/servo-motors.html">Servo Motors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Motors/maverick-dc-motor.html">Maverick DC Motor</a></li>
</ul>
<p class="caption"><span class="caption-text">Servo Control</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Servo/servo-power-block.html">Servo Power Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Servo/servo-smart-programmer.html">Servo Smart Programmer</a></li>
</ul>
<p class="caption"><span class="caption-text">Java Curriculum</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../JavaCurriculum/unit1/index.html">Unit 1: Introduction to Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../JavaCurriculum/unit2/index.html">Unit 2: Starting Java</a></li>
<li class="toctree-l1"><a class="reference internal" href="../JavaCurriculum/unit3/index.html">Unit 3: Java Essentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../JavaCurriculum/unit4/index.html">Unit 4: Inputs and Methods</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Contributing/style-guide.html">Style Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Issues</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/studica/studica-docs-worldskills/issues">Report an Issue</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Studica Robotics</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Calibrating and Using the navX-sensor IMU</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/docs/VMX/navx.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="calibrating-and-using-the-navx-sensor-imu">
<h1>Calibrating and Using the navX-sensor IMU<a class="headerlink" href="#calibrating-and-using-the-navx-sensor-imu" title="Permalink to this headline"></a></h1>
<p>VMX includes an internal navX-Sensor IMU, comprised of 3 gyroscopes, 3 accelerometers, 3 magnetometers and a motion processor which processes data from these sensors and generates measurements of angular orientation and linear acceleration.</p>
<div class="section" id="basic-usage">
<h2>Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline"></a></h2>
<div class="section" id="orientation">
<h3>Orientation<a class="headerlink" href="#orientation" title="Permalink to this headline"></a></h3>
<p>VMX measures a total of 9 sensor axes (3 gyroscope axes, 3 accelerometer axes and 3 magnetometer axes) and fuses them into a 3-D coordinate system. In order to effectively use the values reported by VMX, a few key concepts must be understood in order to correctly install VMX on a robot.</p>
<div class="section" id="d-coordinate-system">
<h4>3-D Coordinate System<a class="headerlink" href="#d-coordinate-system" title="Permalink to this headline"></a></h4>
<p>When controlling a robot in 3 dimensions a set of 3 axes are combined into a 3-D coordinate system, as depicted below:</p>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="../../_images/TriAxis-300x256.png"><img alt="../../_images/TriAxis-300x256.png" src="../../_images/TriAxis-300x256.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">navX-Sensor Coordinate System</span><a class="headerlink" href="#id2" title="Permalink to this image"></a></p>
</div>
<p>In the diagram above, the green rounded arrows represent Rotational motion, and the remaining arrows represent Linear motion.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 11%" />
<col style="width: 20%" />
<col style="width: 28%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Axis</p></th>
<th class="head"><p>Orientation</p></th>
<th class="head"><p>Linear Motion</p></th>
<th class="head"><p>Rotational Motion</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>X (Pitch)</p></td>
<td><p>Left/Right</p></td>
<td><ul class="simple">
<li><p>Left / + Right</p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>Tilt Backwards</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Y (Roll)</p></td>
<td><p>Forward/Backward</p></td>
<td><ul class="simple">
<li><p>Forward / - Backwards</p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>Roll Left</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Z (Yaw)</p></td>
<td><p>Up/Down</p></td>
<td><ul class="simple">
<li><p>Up / - Down</p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>Clockwise / - Counter-clockwise</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="reference-frames">
<h4>Reference Frames<a class="headerlink" href="#reference-frames" title="Permalink to this headline"></a></h4>
<p>Note that the 3-axis coordinate system describes relative motion and orientation; it doesn’t specify the orientation with respect to any other reference.  For instance, what does “left” mean once a robot has rotated 180 degrees?</p>
<p>To address this, the concept of a <a class="reference external" href="https://en.wikipedia.org/wiki/Frame_of_reference">reference frame</a> was invented.  There are three separate three-axis “reference frames” that should be understood:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 23%" />
<col style="width: 24%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Coordinate System</p></th>
<th class="head"><p>Reference Frame</p></th>
<th class="head"><p>X Axis</p></th>
<th class="head"><p>Y Axis</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Field</p></td>
<td><p>World Frame</p></td>
<td><p>Side of Field</p></td>
<td><p>Front (Head) of Field</p></td>
</tr>
<tr class="row-odd"><td><p>Robot</p></td>
<td><p>Body Frame</p></td>
<td><p>Side of Robot</p></td>
<td><p>Front (Head) of Robot</p></td>
</tr>
<tr class="row-even"><td><p>navX-sensor</p></td>
<td><p>Board Frame</p></td>
<td><p>See diagram Below</p></td>
<td><p>See diagram below</p></td>
</tr>
</tbody>
</table>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="../../_images/JoystickAxes.png"><img alt="../../_images/JoystickAxes.png" src="../../_images/JoystickAxes.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Joystick Axes Orientation</span><a class="headerlink" href="#id3" title="Permalink to this image"></a></p>
</div>
<p>Since a three-axis joystick is typically used to control a robot, the robot designer must select upon which Reference Frame the driver joystick is based.  This selection of Reference Frame typically depends upon the drive mode used:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 16%" />
<col style="width: 62%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Drive mode</p></th>
<th class="head"><p>Reference Frame</p></th>
<th class="head"><p>Coordinate Orientation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Standard Drive</p></td>
<td><p>Body Frame</p></td>
<td><p>Forward always points to the front (head) of the robot</p></td>
</tr>
<tr class="row-odd"><td><p>Field-oriented Drive</p></td>
<td><p>World Frame</p></td>
<td><p>Forward always points to the front (head) of the field</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="vmx-board-orientation">
<h4>VMX Board Orientation<a class="headerlink" href="#vmx-board-orientation" title="Permalink to this headline"></a></h4>
<div class="section" id="aligning-board-frame-and-body-frame">
<h5>Aligning Board Frame and Body Frame<a class="headerlink" href="#aligning-board-frame-and-body-frame" title="Permalink to this headline"></a></h5>
<p>In order for the VMX orientation sensor readings to be easily usable by a robot control application, the VMX Coordinate System (Board Frame) must be aligned with the Robot Coordinate system (Body Frame).</p>
</div>
<div class="section" id="aligning-the-yaw-z-axis-and-gravity">
<h5>Aligning the Yaw (Z) axis and Gravity<a class="headerlink" href="#aligning-the-yaw-z-axis-and-gravity" title="Permalink to this headline"></a></h5>
<p>The VMX motion processor takes advantage of the fact that gravity can be measured with its onboard accelerometers, fusing this information with the onboard gyroscopes to yield a very accurate yaw reading with a low rate of drift.  In order to accomplish this, the yaw (Z) axis must be aligned with the “gravity axis” (the axis that points directly up and down with respect to the earth).</p>
<p>When installing VMX on a robot, the VMX yaw (Z) axis and the gravity axis must be aligned.</p>
</div>
<div class="section" id="default-vmx-board-orientation">
<h5>Default VMX Board Orientation<a class="headerlink" href="#default-vmx-board-orientation" title="Permalink to this headline"></a></h5>
<p>The default VMX circuit board orientation is with the VMX logo on the Front Right,  with the top of the circuit board pointing up (with respect to the earth).</p>
<p>Since Body Frame and Board Frame coordinates should be aligned, and because the Yaw axis must be aligned with gravity, by default you must orient the VMX with the top of the board facing up, and with the Y axis (on the circuit board) pointing to the front of the robot.</p>
<p>If you need to mount the VMX circuit board in a different orientation (vertically, horizontally, or upside down), you can use the OmniMount feature to transform the orientation.</p>
</div>
</div>
</div>
<div class="section" id="gyroscope-accelerometer-calibration">
<h3>Gyroscope/Accelerometer Calibration<a class="headerlink" href="#gyroscope-accelerometer-calibration" title="Permalink to this headline"></a></h3>
<p>VMX onboard orientation sensors require calibration in order to yield optimal results. We highly recommend taking the time to understand this calibration process – successful calibration is vital to ensure optimal performance.</p>
<p>Accurate Gyroscope Calibration is crucial in order to yield valid yaw angles. Although this process occurs automatically, understanding how it works is required to obtain the best results.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If you are tempted to ignore this information, please read the section entitled “The Importance of Stillness” at the end of this section.</p>
</div>
<div class="section" id="calibration-process">
<h4>Calibration Process<a class="headerlink" href="#calibration-process" title="Permalink to this headline"></a></h4>
<p>The VMX Calibration Process is comprised of three calibration phases:</p>
<ul class="simple">
<li><p>Factory Calibration</p></li>
<li><p>Startup Calibration</p></li>
<li><p>On-the-fly Calibration</p></li>
</ul>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="../../_images/CalibrationProcess.png"><img alt="../../_images/CalibrationProcess.png" src="../../_images/CalibrationProcess.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">navX-Sensor Calibration Process</span><a class="headerlink" href="#id4" title="Permalink to this image"></a></p>
</div>
<div class="section" id="factory-calibration">
<h5>Factory Calibration<a class="headerlink" href="#factory-calibration" title="Permalink to this headline"></a></h5>
<p>Before VMX units are shipped, the accelerometers and gyroscopes are initially calibrated at the factory; this calibration data is stored in flash memory and applied automatically to the accelerometer and gyroscope data each time the navX-Micro circuit board is powered on.</p>
<p>Note that the onboard gyroscopes are sensitive to temperature changes. Therefore, since the average ambient temperature at the factory (on the island of Kauai in Hawaii) may be different than in your environment, you can optionally choose to re-calibrate the gyroscope by pressing and holding the “CAL” button for at least 10 seconds. When you release the “CAL” button, ensure that the “CAL” Led flashes briefly, and then press the “RESET” button to restart navX-Micro. When VMX is re-started, it will perform the Initial Gyro Calibration – the same process that occurs at our factory. NOTE: It is very important to hold VMX still, and parallel to the earth’s surface, during this Initial Gyro Calibration period. You might consider performing this process before using your robot the first time it is used within a new environment (e.g., when you arrive at a FTC competition event).</p>
<p>The value of re-running Factory Calibration at the same temperature VMX will be operated at is potentially increased yaw accuracy as well as faster Startup Calibration. If a significant temperature shift has occurred since the last Factory Calibration, the Startup Calibration time may take longer than normal, and it’s possible that yaw accuracy will be diminished until the next On-the-fly Gyro Calibration completes.</p>
</div>
<div class="section" id="startup-calibration">
<h5>Startup Calibration<a class="headerlink" href="#startup-calibration" title="Permalink to this headline"></a></h5>
<p>Startup Calibration occurs each time VMX is powered on, and requires that the sensor be held still in order to complete successfully.  Using the Factory Calibration as a starting point, the sensor calibrates the accelerometers and adjusts the gyroscope calibration data as well based upon current temperature conditions.</p>
<p>If the sensor continues to move during startup calibration, Startup Calibration will eventually timeout – and as a result, the VMX yaw angle may not be as accurate as expected.</p>
</div>
<div class="section" id="initial-yaw-offset-calibration">
<h5>Initial Yaw Offset Calibration<a class="headerlink" href="#initial-yaw-offset-calibration" title="Permalink to this headline"></a></h5>
<p>Immediately after Startup Calibration, an Initial Yaw Offset is automatically calculated. The purpose of the Initial Yaw Offset is to ensure that whatever direction the “front” of the VMX circuit board is pointed to at startup (after initial calibration is applied) will be considered “0 degrees”.</p>
<p>Yaw Offset Calibration requires that VMX be still for approximately 2 seconds after Startup Calibration completes. After approximately 2 seconds of no motion, VMX will acquire the current yaw angle, and will subtract it from future yaw measurements automatically. The VMX protocol and libraries provide a way to determine the yaw offset value it is currently using.</p>
<p>NOTE: If VMX is moving during startup, this Yaw Offset Calibration may take much longer than 2 seconds, and  may not be calculated at all if the sensor continues moving long enough. Therefore it is highly-recommended to keep VMX still until initial calibration and Initial Yaw Offset calibration completes.</p>
</div>
<div class="section" id="on-the-fly-gyro-calibration">
<h5>On-the-fly Gyro Calibration<a class="headerlink" href="#on-the-fly-gyro-calibration" title="Permalink to this headline"></a></h5>
<p>In addition to Startup Calibration, during normal operation VMX will automatically re-calibrate the gyroscope (e.g., to account for ongoing temperature changes) during operation, whenever it detects 8 seconds of no motion. This process completes after about 7-8 more seconds, and is completely transparent to the user. Therefore each time VMX is still for approximately 15 seconds, the gyroscopes are re-calibrated “on-the-fly”. The purpose of On-the-fly Gyro re-calibration is to help maintain yaw accuracy when shifts in ambient temperature occur during operation.</p>
<p>This On-the-fly Gyro Calibration can help deal with cases where the sensor was moving during Startup Calibration, but note that the yaw is not zeroed at the completion of On-the-fly Calibration.  So once again, it’s important to keep the sensor still during Startup Calibration.</p>
</div>
<div class="section" id="runtime-yaw-zeroing">
<h5>Runtime Yaw Zeroing<a class="headerlink" href="#runtime-yaw-zeroing" title="Permalink to this headline"></a></h5>
<p>Your robot software can optionally provide the robot operator a way to reset the yaw angle to Zero at any time. Please see the documentation for the VMX libraries for more details.</p>
</div>
<div class="section" id="the-importance-of-stillness">
<h5>The importance of stillness<a class="headerlink" href="#the-importance-of-stillness" title="Permalink to this headline"></a></h5>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This is the most important takeaway from this discussion: It is highly-recommended that VMX be held still during the above Initial Gyro and Initial Yaw Offset calibration periods. In support of this, VMX indicates when it is calibrating; we recommend you incorporate this information into your software. Please see the discussion of the navXUI, and the VMX libraries for more details on this indication.</p>
</div>
</div>
</div>
</div>
<div class="section" id="navxui">
<h3>navXUI<a class="headerlink" href="#navxui" title="Permalink to this headline"></a></h3>
<p>The navXUI user interface application provides a simple way to visualize the data provided by VMX.</p>
<div class="figure align-center" id="id5">
<img alt="../../_images/navXUI_vmx-pi.png" src="../../_images/navXUI_vmx-pi.png" />
<p class="caption"><span class="caption-text">navXUI</span><a class="headerlink" href="#id5" title="Permalink to this image"></a></p>
</div>
<p>To install and run navXUI:</p>
<ul class="simple">
<li><p>Download the <a class="reference external" href="https://www.kauailabs.com/public_files/vmx-pi/vmx-pi.zip">VMX Tools for Windows</a> latest build.</p></li>
<li><p>Unpack the contents of the vmx-pi.zip file and run the setup.exe program</p></li>
<li><p>Connect a USB cable between the VMX circuit board and your Windows computer.</p></li>
<li><p>From the Windows Menus, click on Kauai Labs-&gt;navXUI</p></li>
</ul>
<div class="section" id="gyro-calibration-in-progress-indicator">
<h4>Gyro Calibration in Progress Indicator<a class="headerlink" href="#gyro-calibration-in-progress-indicator" title="Permalink to this headline"></a></h4>
<p>The Gyro Calibration in Progress Indicator is displayed during initial gyroscope calibration, which occurs immediately after power is applied to VMX. If the gyroscope calibration does not complete, VMX yaw accuracy will be adversely impacted. For more information on Gyro Calibration, please see the Gyro/Accelerometer Calibration page.</p>
</div>
<div class="section" id="motion-indicators">
<h4>Motion Indicators<a class="headerlink" href="#motion-indicators" title="Permalink to this headline"></a></h4>
<p>VMX provides dynamic motion indicators: (a) the “Moving” indicator and (b) the “Rotating” indicator.</p>
<p>The Moving indicator is present whenever the current Gravity-corrected Linear Acceleration exceeds the “Motion Threshold”.</p>
<p>The Rotating indicator is present whenever the change in yaw value within the last second exceeds the “Rotating Threshold”. Note that VMX Gyroscope Calibration only occurs when VMX is not Rotating for a few seconds.</p>
</div>
<div class="section" id="gravity-corrected-linear-acceleration-g">
<h4>Gravity-corrected Linear Acceleration (G)<a class="headerlink" href="#gravity-corrected-linear-acceleration-g" title="Permalink to this headline"></a></h4>
<p>VMX automatically subtracts acceleration due to gravity from accelerometer data, and displays the resulting linear acceleration. These measures are in units of instantaneous G, and are in World Reference Frame.</p>
</div>
<div class="section" id="sensor-temperature">
<h4>Sensor Temperature<a class="headerlink" href="#sensor-temperature" title="Permalink to this headline"></a></h4>
<p>The Sensor Temperature indicates the die temperature of the MPU-9250 IC. Since shifts in gyro temperature can impact yaw accuracy, VMX will automatically perform Gyroscope calibration whenever VMX is still. See the Gyro/Accelerometer Calibration page for more details.</p>
</div>
<div class="section" id="magnetic-disturbance-indicator">
<h4>Magnetic Disturbance Indicator<a class="headerlink" href="#magnetic-disturbance-indicator" title="Permalink to this headline"></a></h4>
<p>Once the VMX Magnetometer has been calibrated (see the Magnetometer Calibration page), whenever the current magnetic field diverges from the calibrated value for the earth’s magnetic field, a magnetic disturbance is indicated.</p>
</div>
<div class="section" id="yaw-angle">
<h4>Yaw Angle<a class="headerlink" href="#yaw-angle" title="Permalink to this headline"></a></h4>
<p>The Yaw Angle is displayed in grey text if Gyro Calibration has not yet been completed. Once Gyro Calibration is complete, the Yaw Angle text color will change to white.</p>
</div>
<div class="section" id="pitch-roll-angles">
<h4>Pitch/Roll Angles<a class="headerlink" href="#pitch-roll-angles" title="Permalink to this headline"></a></h4>
<p>The Pitch/Roll Angles are always displayed in white text, since Accelerometer calibration occurs at the Kauai Labs factory.</p>
</div>
<div class="section" id="compass-angle">
<h4>Compass Angle<a class="headerlink" href="#compass-angle" title="Permalink to this headline"></a></h4>
<p>The Compass Angle displays the tilt-compensated compass heading calculated from VMX’s Magnetometer combined with the tip/tilt measure from the Accelerometers.</p>
<p>The Compass Angle is displayed in grey text if Magnetometer Calibration has not yet been completed. Once Magnetometer Calibration is complete, the Compass Angle text color will change to white.</p>
</div>
<div class="section" id="axis-fused-heading">
<h4>9-axis (“Fused”) Heading<a class="headerlink" href="#axis-fused-heading" title="Permalink to this headline"></a></h4>
<p>The 9-axis heading is displayed in grey text if Magnetometer Calibration has not yet been completed and/or if no undisturbed magnetic readings have occurred.</p>
</div>
<div class="section" id="running-navxui">
<h4>Running navXUI<a class="headerlink" href="#running-navxui" title="Permalink to this headline"></a></h4>
<p>To start navXUI, from your Start Menu select “Kauai Labs” and then “VMX-pi” and click on the “navXUI” icon to start navXUI.</p>
<p>If your computer has more than one serial port, you can select which serial port to use by clicking on the up/down arrows in the COM port selection control in the UI.</p>
</div>
</div>
<div class="section" id="yaw-drift">
<h3>Yaw Drift<a class="headerlink" href="#yaw-drift" title="Permalink to this headline"></a></h3>
<p>A gyroscope measures the amount of angular rotation about a single axis. Since the gyroscope measures changes in angular rotation, rather than an absolute angle, calculation of the actual current angle of that axis is estimated via numerical integration rather than an exact measurement.</p>
<p>Any Inertial Measurement Unit (IMU), including the VMX_pi IMU, that integrates a signal from a gyroscope will also accumulate error over time. Accumulated error is due to several factors, including:</p>
<ul class="simple">
<li><p>Quantization noise (which occurs when an analog-to-digital converter (ADC) converts a continuous analog value to a discrete integral value)</p></li>
<li><p>Scale factor error (which occurs due to manufacturing errors causing a specified scale factor [e.g., 256 bits per unit G] to be incorrect)</p></li>
<li><p>Temperature instability (which occurs when a sensor is more or less sensitive to an input as temperature changes)</p></li>
<li><p>Bias error (which occurs because the value the sensor reports at ‘zero’ is not known well enough to ‘subtract’ that value out during signal processing)</p></li>
</ul>
<p>Over time, these errors accumulate leading to greater and greater amounts of error.</p>
<p>With the VMX orientation sensor, Quantization error is minimized due to the sensor internal signal conditioning, high-resolution 16-bit Analog-to-Digital Converters (ADC), and extremely fast internal sampling (200Hz). Scale factor error is easily corrected for by factory calibration, which VMX provides. So these two noise sources are not significant in VMX.</p>
<p>The remaining sources of error – temperature instability and bias error – are more challenging to overcome:</p>
<p>Gyro bias error is a major contributor to yaw drift error, but is inherent in modern MEMS-based gyroscopes used in the navX-Sensor.</p>
<p>Temperature instability can cause major amounts of error, and should be managed to get the best result. To address this, the navX-sensor automatically re-calibrates the gyro biases whenever it is still for several seconds, which helps manages temperature instability.
Errors in the VMX Pitch and Roll values to be extremely accurate over time since gyroscope values in the pitch/roll axes can be compared to the corresponding values from the accelerometer. This is because when VMX is still, the accelerometer data reflects only the linear acceleration due to gravity.</p>
<p>Correcting for integration error in the Yaw axis is more complicated, since the accelerometer values in this axis are the same no matter how much yaw rotation exists.</p>
<p>To deal with this, several different “data fusion” algorithms have been developed, including the Extended Kalman Filter (EKF) used by the navX-sensor.  THe EKF filter is designed to process 3-axis accelerometer and 3-axis gyroscope values and yield yaw/pitch/roll values.</p>
<p>With this processing, VMX exhibits yaw drift on the order of ~1 degree per minute; yaw drift is typically much lower when VMX is still.</p>
</div>
<div class="section" id="best-practices">
<h3>Best Practices<a class="headerlink" href="#best-practices" title="Permalink to this headline"></a></h3>
<p>This page summarizes the recommended best practices when integrating VMX with a robot.  Following these best practices will help ensure high reliability and consistent operation.</p>
<ol class="arabic simple">
<li><p>Secure VMX circuit board to the Robot Chassis</p></li>
</ol>
<p>Excessive vibration will reduce the quality of VMX orientation sensor measurements. The VMX circuit board should be mounted in such a way that it as firmly attached to the robot chassis.</p>
<ol class="arabic simple" start="2">
<li><p>Understand and Plan for Calibration</p></li>
</ol>
<p>Gyro/Accelerometer Calibration is vital to achieving high-quality VMX IMU readings. Be sure to understand this process, and ensure that it completes successfully each time you use the robot.</p>
<p>If your robot moves during calibration, or if noticeable temperature changes occur during calibration, the calibration process may take longer than normal.</p>
<p>Using the VMX yaw angle before calibration completes may result in errors in robot control. To avoid this situation, your robot software should verify that calibration has completed before using VMX IMU data.</p>
<ol class="arabic simple" start="3">
<li><p>Protect the Circuitry</p></li>
</ol>
<p>VMX contains sensitive circuitry. The VMX circuit board should be handled carefully.</p>
<p>An enclosure is recommended to protect the VMX circuit board from excessive handling, “swarf”, electro-static discharge (ESD) and other elements that could potentially damage VMX circuitry.</p>
<ol class="arabic simple" start="4">
<li><p>Provide a “Zero Yaw” feature (for Field-Oriented Drive)</p></li>
</ol>
<p>The VMX gyro “yaw” angle will drift over time (approximately 1 degree/minute). While this does not normally impact the robot during a typical FRC match, if using field-oriented drive during extended practice sessions it may be necessary to periodically “zero” the yaw. Drivers should be provided a simple way (e.g., a joystick button) with which to zero the yaw.</p>
<ol class="arabic simple" start="5">
<li><p>If possible, mount VMX near the center of rotation</p></li>
</ol>
<p>Since VMX measures rotation, errors in the measured angles can occur if VMX is mounted at a point not near the robot center of rotation. For optimal results, VMX should be mounted at the robot’s center of rotation. If VMX cannot be mounted near the robot’s center of rotation, the offset from the center of rotation can be used to correct the yaw angle.</p>
<ol class="arabic simple" start="6">
<li><p>Use OmniMount if VMX is not mounted horizontally</p></li>
</ol>
<p>By default, VMX’s motion processing requires the unit be mounted horizontally, parallel to the earth’s surface; the yaw (Z) axis should be perpendicular to the earths surface.</p>
<p>If you need to mount VMX vertically or upside-down, you will need to enable the “OmniMount” feature in order to get reliable, accurate yaw (Z) axis readings.</p>
<ol class="arabic simple" start="7">
<li><p>Learn how the sensor behaves by using the navXUI</p></li>
</ol>
<p>The navXUI provides insight into the key VMX IMU features, and can help debug issues you may encounter when integrating VMX onto your robot. Running this user interface is highly recommended for anyone using VMX.</p>
</div>
</div>
<div class="section" id="advanced-usage">
<h2>Advanced Usage<a class="headerlink" href="#advanced-usage" title="Permalink to this headline"></a></h2>
<div class="section" id="omnimount">
<h3>Omnimount<a class="headerlink" href="#omnimount" title="Permalink to this headline"></a></h3>
<p>If the VMX default yaw axis orientation isn’t sufficient for your needs, you can use the OmniMount feature to re-configure the VMX yaw axis, allowing high-accuracy yaw axis readings when VMX is mounted horizontally, vertically, or even upside down.</p>
<p>In certain cases, the VMX axes (Board Frame) may not be oriented exactly as that of the Robot (Body Frame).   For instance, if the VMX circuit board is mounted sideways, the navX-Sensor axes will not be oriented identically to the Robot.</p>
<div class="section" id="transforming-vmx-board-frame-to-body-frame-with-omnimount">
<h4>Transforming VMX Board Frame to Body Frame with OmniMount<a class="headerlink" href="#transforming-vmx-board-frame-to-body-frame-with-omnimount" title="Permalink to this headline"></a></h4>
<p>VMX’s “OmniMount” feature can transform the VMX X, Y and Z axis sensor data (Board Frame) into Robot Orientation (Body Frame) by detecting which of its three axes is perpendicular to the earth’s surface.</p>
<p>This is similar to how a modern smart phone will rotate the display based upon the phone’s orientation.  However unlike a smart phone, the OmniMount detection of orientation does not happen all the time – since the orientation should not change while the robot is moving.  Rather, each time OmniMount configuration occurs, VMX records this transformation in persistent flash memory, and will continue to perform this transformation until the transform is reconfigured.</p>
<p>To configure OmniMount, follow these simple steps:</p>
<ul class="simple">
<li><p>Install VMX onto your robot. ENSURE that one of the VMX axes (as shown on the VMX circuit board) is perpendicular to the earth’s surface.  This axis will become the yaw (Z) axis.  Note that this axis can either be pointing away from the earth’s surface, or  towards the earth’s surface.</p></li>
<li><p>Press the ‘CAL’ button on the VMX Circuit board AND HOLD THE BUTTON DOWN FOR AT LEAST 5 SECONDS.</p></li>
<li><p>Release the ‘CAL’ button, and verify that the orange ‘CAL’ light flashes for 1 second and then turns off.</p></li>
<li><p>Press the ‘RESET’ button on the VMX circuit board, causing it to restart.</p></li>
</ul>
<p>The VMX circuit board will now begin OmniMount auto-calibration. During this auto-calibration period, the orange ‘CAL’ LED will flash repeatedly.  This process takes approximately 15 seconds, and requires two things:
1.  During auto-calibration, one of the VMX axes MUST be perpendicular to the earth’s surface.
2.  During auto-calibration, the VMX must be held still.
If either of the above conditions is not true, the ‘CAL’ LED will be flashing quickly, indicating an error.  To resolve this error, you must ensure that conditions 1 and 2 are met, at which point the ‘CAL’ LED will begin flashing slowly, indicating calibration is underway.
Once the VMX auto-calibration is complete, the Board Frame to Body Frame Transform will be stored persistently into VMX flash memory and used until auto-calibration is run once again.</p>
</div>
</div>
<div class="section" id="magnetometer-calibration">
<h3>Magnetometer Calibration<a class="headerlink" href="#magnetometer-calibration" title="Permalink to this headline"></a></h3>
<p>Careful and accurate Magnetometer Calibration is crucial in order to yield valid compass heading, 9-axis heading and magnetic disturbance detection.</p>
<p>VMX onboard orientation sensors require calibration in order to yield optimal results. We highly recommend taking the time to understand this calibration process – successful calibration is vital to ensure optimal performance.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Magnetometer Calibration is not typically required in many robotics applications, including Field-oriented drive.  Magnetometer Calibration is a manual process and is only recommended for advanced users who need to calculate absolute heading.</p>
</div>
<p>To install and run the Magnetometer Calibration Tool:</p>
<ul class="simple">
<li><p>Download the <a class="reference external" href="https://www.kauailabs.com/public_files/vmx-pi/vmx-pi.zip">VMX Tools for Windows</a> latest build.</p></li>
<li><p>Unpack the contents of the vmx-pi.zip file and run the setup.exe program</p></li>
<li><p>Connect a USB cable between the VMX circuit board and your Windows computer.</p></li>
<li><p>From the Windows Menus, click on Kauai Labs-&gt;navXMagCalibrator</p></li>
</ul>
<div class="section" id="id1">
<h4>Calibration Process<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h4>
<p>The magnetometer calibration encompasses three areas: (a) hard-iron calibration, (b) soft-iron calibration and (c) magnetic disturbance calibration.</p>
<p>Hard and soft-iron calibration allows the following equation to be used, and corrects for hard and soft-iron effects due to nearby ferrous metals and magnetic fields. This calibration is necessary in order to achieve valid compass heading readings:</p>
<p>In addition, using the same calibration data the strength of the Earth’s Magnetic Field is determined. Whenever the data from the magnetometer indicates the current magnetic field differs from the calibrated Earth’s Magnetic Field strength by more than the “Magnetic Disturbance Ratio”, a Magnetic Anomaly is declared.</p>
<p>Therefore, careful and accurate Magnetometer Calibration is crucial in order to yield valid compass heading, 9-axis heading and magnetic disturbance detection.</p>
<p>Magnetometer Calibration can be accomplished with a single, simple calibration process through the use of the <a class="reference external" href="https://pdocs.kauailabs.com/vmx-pi/software/tools/magnetometer-calibration-tool/">Magnetometer Calibration Tool</a>. This tool is designed to run on a Windows computer, and communicate to the VMX circuit board via a USB cable.</p>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="vision.html" class="btn btn-neutral float-left" title="Configuring and Testing the SR Pro Camera" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="update.html" class="btn btn-neutral float-right" title="Updating Firmware" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Studica.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>